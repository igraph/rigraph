<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function handles all the steps involved in the Spectral Coarse Graining
(SCG) of some matrices and graphs as described in the reference below."><title>All-in-one Function for the SCG of Matrices and Graphs — scg • igraph</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="All-in-one Function for the SCG of Matrices and Graphs — scg"><meta property="og:description" content="This function handles all the steps involved in the Spectral Coarse Graining
(SCG) of some matrices and graphs as described in the reference below."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">igraph</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.1.9002</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-get-started">Get started</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-get-started">
    <a class="dropdown-item" href="../articles/igraph.html">Intro</a>
    <a class="dropdown-item" href="../articles/igraph_ES.html">Intro (Español)</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/installation-troubleshooting.html">Installation FAQs</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">All articles</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/igraph/rigraph/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>All-in-one Function for the SCG of Matrices and Graphs</h1>
      <small class="dont-index">Source: <a href="https://github.com/igraph/rigraph/blob/HEAD/R/scg.R" class="external-link"><code>R/scg.R</code></a></small>
      <div class="d-none name"><code>scg.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function handles all the steps involved in the Spectral Coarse Graining
(SCG) of some matrices and graphs as described in the reference below.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">scg</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">ev</span>,</span>
<span>  <span class="va">nt</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mtype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"symmetric"</span>, <span class="st">"laplacian"</span>, <span class="st">"stochastic"</span><span class="op">)</span>,</span>
<span>  algo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"optimum"</span>, <span class="st">"interv_km"</span>, <span class="st">"interv"</span>, <span class="st">"exact_scg"</span><span class="op">)</span>,</span>
<span>  norm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"row"</span>, <span class="st">"col"</span><span class="op">)</span>,</span>
<span>  direction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"default"</span>, <span class="st">"left"</span>, <span class="st">"right"</span><span class="op">)</span>,</span>
<span>  evec <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use.arpack <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  maxiter <span class="op">=</span> <span class="fl">300</span>,</span>
<span>  sparse <span class="op">=</span> <span class="fu"><a href="igraph_options.html">igraph_opt</a></span><span class="op">(</span><span class="st">"sparsematrices"</span><span class="op">)</span>,</span>
<span>  output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"default"</span>, <span class="st">"matrix"</span>, <span class="st">"graph"</span><span class="op">)</span>,</span>
<span>  semproj <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  epairs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  stat.prob <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>X</dt>
<dd><p>The input graph or square matrix. Can be of class <code>igraph</code>,
<code>matrix</code> or <code>Matrix</code>.</p></dd>


<dt>ev</dt>
<dd><p>A vector of positive integers giving the indexes of the eigenpairs
to be preserved. For real eigenpairs, 1 designates the eigenvalue with
largest algebraic value, 2 the one with second largest algebraic value, etc.
In the complex case, it is the magnitude that matters.</p></dd>


<dt>nt</dt>
<dd><p>A vector of positive integers of length one or equal to
<code>length(ev)</code>. When <code>algo</code> = “optimum”, <code>nt</code> contains
the number of groups used to partition each eigenvector separately. When
<code>algo</code> is equal to “interv_km” or “interv”, <code>nt</code>
contains the number of intervals used to partition each eigenvector. The
same partition size or number of intervals is used for each eigenvector if
<code>nt</code> is a single integer. When <code>algo</code> = “exact_cg” this
parameter is ignored.</p></dd>


<dt>groups</dt>
<dd><p>A vector of <code>nrow(X)</code> or <code>vcount(X)</code> integers
labeling each group vertex in the partition. If this parameter is supplied
most part of the function is bypassed.</p></dd>


<dt>mtype</dt>
<dd><p>Character scalar. The type of semi-projector to be used for the
SCG. For now “symmetric”, “laplacian” and “stochastic”
are available.</p></dd>


<dt>algo</dt>
<dd><p>Character scalar. The algorithm used to solve the SCG problem.
Possible values are “optimum”, “interv_km”, “interv”
and “exact_scg”.</p></dd>


<dt>norm</dt>
<dd><p>Character scalar. Either “row” or “col”. If set to
“row” the rows of the Laplacian matrix sum up to zero and the rows of
the stochastic matrix sum up to one; otherwise it is the columns.</p></dd>


<dt>direction</dt>
<dd><p>Character scalar. When set to “right”, resp.
“left”, the parameters <code>ev</code> and <code>evec</code> refer to right,
resp. left eigenvectors. When passed “default” it is the SCG
described in the reference below that is applied (common usage). This
argument is currently not implemented, and right eigenvectors are always
used.</p></dd>


<dt>evec</dt>
<dd><p>A numeric matrix of (eigen)vectors to be preserved by the coarse
graining (the vectors are to be stored column-wise in <code>evec</code>). If
supplied, the eigenvectors should correspond to the indexes in <code>ev</code> as
no cross-check will be done.</p></dd>


<dt>p</dt>
<dd><p>A probability vector of length <code>nrow(X)</code> (or
<code>vcount(X)</code>). <code>p</code> is the stationary probability distribution of a
Markov chain when <code>mtype</code> = “stochastic”. This parameter is
ignored in all other cases.</p></dd>


<dt>use.arpack</dt>
<dd><p>Logical scalar. When set to <code>TRUE</code> uses the function
<code><a href="arpack.html">arpack()</a></code> to compute eigenpairs. This parameter should be set to
<code>TRUE</code> if one deals with large (over a few thousands) AND sparse graphs
or matrices. This argument is not implemented currently and LAPACK is used
for solving the eigenproblems.</p></dd>


<dt>maxiter</dt>
<dd><p>A positive integer giving the maximum number of iterations
for the k-means algorithm when <code>algo</code> = “interv_km”. This
parameter is ignored in all other cases.</p></dd>


<dt>sparse</dt>
<dd><p>Logical scalar. Whether to return sparse matrices in the
result, if matrices are requested.</p></dd>


<dt>output</dt>
<dd><p>Character scalar. Set this parameter to “default” to
retrieve a coarse-grained object of the same class as <code>X</code>.</p></dd>


<dt>semproj</dt>
<dd><p>Logical scalar. Set this parameter to <code>TRUE</code> to retrieve
the semi-projectors of the SCG.</p></dd>


<dt>epairs</dt>
<dd><p>Logical scalar. Set this to <code>TRUE</code> to collect the
eigenpairs computed by <code>scg()</code>.</p></dd>


<dt>stat.prob</dt>
<dd><p>Logical scalar. This is to collect the stationary
probability <code>p</code> when dealing with stochastic matrices.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <dl><dt>Xt</dt>
<dd><p>The coarse-grained graph, or matrix, possibly a sparse
matrix.</p></dd>
 <dt>groups</dt>
<dd><p>A vector of <code>nrow(X)</code> or <code>vcount(X)</code>
integers giving the group label of each object (vertex) in the partition.</p></dd>

<dt>L</dt>
<dd><p>The semi-projector \(L\) if <code>semproj = TRUE</code>.</p></dd>
 <dt>R</dt>
<dd><p>The
semi-projector \(R\) if <code>semproj = TRUE</code>.</p></dd>
 <dt>values</dt>
<dd><p>The computed
eigenvalues if <code>epairs = TRUE</code>.</p></dd>
 <dt>vectors</dt>
<dd><p>The computed or
supplied eigenvectors if <code>epairs = TRUE</code>.</p></dd>
 <dt>p</dt>
<dd><p>The stationary
probability vector if <code>mtype = stochastic</code> and <code>stat.prob = TRUE</code>.
For other matrix types this is missing.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Please see <a href="scg-method.html">scg-method</a> for an introduction.</p>
<p>In the following \(V\) is the matrix of eigenvectors for which the SCG is
solved. \(V\) is calculated from <code>X</code>, if it is not given in the
<code>evec</code> argument.</p>
<p>The algorithm “optimum” solves exactly the SCG problem for each
eigenvector in <code>V</code>. The running time of this algorithm is \(O(\max
nt \cdot m^2)\) for the symmetric and laplacian matrix
problems (i.e. when <code>mtype</code> is “symmetric” or
“laplacian”. It is \(O(m^3)\) for the stochastic problem. Here
\(m\) is the number of rows in <code>V</code>.  In all three cases, the memory
usage is \(O(m^2)\).</p>
<p>The algorithms “interv” and “interv_km” solve approximately
the SCG problem by performing a (for now) constant binning of the components
of the eigenvectors, that is <code>nt[i]</code> constant-size bins are used to
partition <code>V[,i]</code>. When <code>algo</code> = “interv_km”, the (Lloyd)
k-means algorithm is run on each partition obtained by “interv” to
improve accuracy.</p>
<p>Once a minimizing partition (either exact or approximate) has been found for
each eigenvector, the final grouping is worked out as follows: two vertices
are grouped together in the final partition if they are grouped together in
each minimizing partition. In general the size of the final partition is not
known in advance when <code>ncol(V)</code>&gt;1.</p>
<p>Finally, the algorithm “exact_scg” groups the vertices with equal
components in each eigenvector. The last three algorithms essentially have
linear running time and memory load.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>D. Morton de Lachapelle, D. Gfeller, and P. De Los Rios,
Shrinking Matrices while Preserving their Eigenpairs with Application to the
Spectral Coarse Graining of Graphs. Submitted to <em>SIAM Journal on
Matrix Analysis and Applications</em>, 2008.
<a href="http://people.epfl.ch/david.morton" class="external-link">http://people.epfl.ch/david.morton</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="scg-method.html">scg-method</a> for an introduction.  <code><a href="scg_eps.html">scg_eps()</a></code>,
<code><a href="scg_group.html">scg_group()</a></code> and <code><a href="scg_semi_proj.html">scg_semi_proj()</a></code>.</p>
<p>Spectral Coarse Graining
<code><a href="scg-method.html">scg-method</a></code>,
<code><a href="scg_eps.html">scg_eps</a>()</code>,
<code><a href="scg_group.html">scg_group</a>()</code>,
<code><a href="scg_semi_proj.html">scg_semi_proj</a>()</code>,
<code><a href="stochastic_matrix.html">stochastic_matrix</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>David Morton de Lachapelle,
<a href="http://people.epfl.ch/david.morton" class="external-link">http://people.epfl.ch/david.morton</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">## We are not running these examples any more, because they</span></span></span>
<span class="r-in"><span><span class="co">## take a long time (~20 seconds) to run and this is against the CRAN</span></span></span>
<span class="r-in"><span><span class="co">## repository policy. Copy and paste them by hand to your R prompt if</span></span></span>
<span class="r-in"><span><span class="co">## you want to run them.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># SCG of a toy network</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="make_full_graph.html">make_full_graph</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="disjoint_union.html">%du%</a></span> <span class="fu"><a href="make_full_graph.html">make_full_graph</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="disjoint_union.html">%du%</a></span> <span class="fu"><a href="make_full_graph.html">make_full_graph</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="add_edges.html">add_edges</a></span><span class="op">(</span><span class="va">g</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">6</span>, <span class="fl">1</span>, <span class="fl">11</span>, <span class="fl">6</span>, <span class="fl">11</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cg</span> <span class="op">&lt;-</span> <span class="fu">scg</span><span class="op">(</span><span class="va">g</span>, <span class="fl">1</span>, <span class="fl">3</span>, algo <span class="op">=</span> <span class="st">"exact_scg"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the result</span></span></span>
<span class="r-in"><span><span class="va">layout</span> <span class="op">&lt;-</span> <span class="fu"><a href="layout_with_kk.html">layout_with_kk</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nt</span> <span class="op">&lt;-</span> <span class="fu"><a href="gorder.html">vcount</a></span><span class="op">(</span><span class="va">cg</span><span class="op">$</span><span class="va">Xt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="va">nt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vsize</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">cg</span><span class="op">$</span><span class="va">groups</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ewidth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="E.html">E</a></span><span class="op">(</span><span class="va">cg</span><span class="op">$</span><span class="va">Xt</span><span class="op">)</span><span class="op">$</span><span class="va">weight</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g</span>,</span></span>
<span class="r-in"><span>  vertex.color <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="va">cg</span><span class="op">$</span><span class="va">groups</span><span class="op">]</span>, vertex.size <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  vertex.label <span class="op">=</span> <span class="cn">NA</span>, layout <span class="op">=</span> <span class="va">layout</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cg</span><span class="op">$</span><span class="va">Xt</span>,</span></span>
<span class="r-in"><span>  edge.width <span class="op">=</span> <span class="va">ewidth</span>, edge.label <span class="op">=</span> <span class="va">ewidth</span>,</span></span>
<span class="r-in"><span>  vertex.color <span class="op">=</span> <span class="va">col</span>, vertex.size <span class="op">=</span> <span class="fl">20</span> <span class="op">*</span> <span class="va">vsize</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">vsize</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  vertex.label <span class="op">=</span> <span class="cn">NA</span>, layout <span class="op">=</span> <span class="va">layout_with_kk</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## SCG of real-world network</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://igraph.org" class="external-link">igraphdata</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">immuno</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">immuno</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="gorder.html">vcount</a></span><span class="op">(</span><span class="va">immuno</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">interv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">50</span>, <span class="fl">25</span>, <span class="fl">12</span>, <span class="fl">6</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cg</span> <span class="op">&lt;-</span> <span class="fu">scg</span><span class="op">(</span><span class="va">immuno</span>,</span></span>
<span class="r-in"><span>  ev <span class="op">=</span> <span class="va">n</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span>, nt <span class="op">=</span> <span class="va">interv</span>, mtype <span class="op">=</span> <span class="st">"laplacian"</span>,</span></span>
<span class="r-in"><span>  algo <span class="op">=</span> <span class="st">"interv"</span>, epairs <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## are the eigenvalues well-preserved?</span></span></span>
<span class="r-in"><span><span class="va">gt</span> <span class="op">&lt;-</span> <span class="va">cg</span><span class="op">$</span><span class="va">Xt</span></span></span>
<span class="r-in"><span><span class="va">nt</span> <span class="op">&lt;-</span> <span class="fu"><a href="gorder.html">vcount</a></span><span class="op">(</span><span class="va">gt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Lt</span> <span class="op">&lt;-</span> <span class="fu"><a href="laplacian_matrix.html">laplacian_matrix</a></span><span class="op">(</span><span class="va">gt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">evalt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">Lt</span>, only.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="va">nt</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">interv</span>, <span class="va">cg</span><span class="op">$</span><span class="va">values</span>, <span class="va">evalt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"interv"</span>, <span class="st">"lambda_i"</span>, <span class="st">"lambda_tilde_i"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"N-1"</span>, <span class="st">"N-2"</span>, <span class="st">"N-3"</span>, <span class="st">"N-4"</span>, <span class="st">"N-5"</span>, <span class="st">"N-6"</span>, <span class="st">"N-7"</span>, <span class="st">"N-8"</span>, <span class="st">"N-9"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## use SCG to get the communities</span></span></span>
<span class="r-in"><span><span class="va">com</span> <span class="op">&lt;-</span> <span class="fu">scg</span><span class="op">(</span><span class="fu"><a href="laplacian_matrix.html">laplacian_matrix</a></span><span class="op">(</span><span class="va">immuno</span><span class="op">)</span>, ev <span class="op">=</span> <span class="va">n</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, nt <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">groups</span></span></span>
<span class="r-in"><span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">com</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">layout</span> <span class="op">&lt;-</span> <span class="fu"><a href="layout_nicely.html">layout_nicely</a></span><span class="op">(</span><span class="va">immuno</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">immuno</span>,</span></span>
<span class="r-in"><span>  layout <span class="op">=</span> <span class="va">layout</span>, vertex.size <span class="op">=</span> <span class="fl">3</span>, vertex.color <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="va">com</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  vertex.label <span class="op">=</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## display the coarse-grained graph</span></span></span>
<span class="r-in"><span><span class="va">gt</span> <span class="op">&lt;-</span> <span class="fu"><a href="simplify.html">simplify</a></span><span class="op">(</span><span class="fu"><a href="as.directed.html">as.undirected</a></span><span class="op">(</span><span class="va">gt</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">layout.cg</span> <span class="op">&lt;-</span> <span class="fu"><a href="layout_with_kk.html">layout_with_kk</a></span><span class="op">(</span><span class="va">gt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">com.cg</span> <span class="op">&lt;-</span> <span class="fu">scg</span><span class="op">(</span><span class="fu"><a href="laplacian_matrix.html">laplacian_matrix</a></span><span class="op">(</span><span class="va">gt</span><span class="op">)</span>, <span class="va">nt</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">groups</span></span></span>
<span class="r-in"><span><span class="va">vsize</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">cg</span><span class="op">$</span><span class="va">groups</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">immuno</span>,</span></span>
<span class="r-in"><span>  layout <span class="op">=</span> <span class="va">layout</span>, vertex.size <span class="op">=</span> <span class="fl">3</span>, vertex.color <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="va">com</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  vertex.label <span class="op">=</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gt</span>,</span></span>
<span class="r-in"><span>  layout <span class="op">=</span> <span class="va">layout.cg</span>, vertex.size <span class="op">=</span> <span class="fl">15</span> <span class="op">*</span> <span class="va">vsize</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">vsize</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  vertex.color <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="va">com.cg</span><span class="op">]</span>, vertex.label <span class="op">=</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://github.com/gaborcsardi" class="external-link">Gábor Csárdi</a>, <a href="https://github.com/ntamas" class="external-link">Tamás Nepusz</a>, <a href="https://www.traag.net/" class="external-link">Vincent Traag</a>, <a href="http://szhorvat.net/" class="external-link">Szabolcs Horvát</a>, <a href="https://fabilab.org/pages/people.html" class="external-link">Fabio Zanini</a>, <a href="https://github.com/GroteGnoom" class="external-link">Daniel Noom</a>, <a href="https://krlmlr.info/" class="external-link">Kirill Müller</a>, Chan Zuckerberg Initiative.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

