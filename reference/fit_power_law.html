<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fitting a power-law distribution function to discrete data — fit_power_law • igraph</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting a power-law distribution function to discrete data — fit_power_law"><meta name="description" content="fit_power_law() fits a power-law distribution to a data set."><meta property="og:description" content="fit_power_law() fits a power-law distribution to a data set."><meta property="og:image" content="https://r.igraph.org/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">igraph</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.3.9059</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-get-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Get started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-get-started"><li><a class="dropdown-item" href="../articles/igraph.html">Intro</a></li>
    <li><a class="dropdown-item" href="../articles/igraph_ES.html">Intro (Español)</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/installation-troubleshooting.html">Installation FAQs</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">All articles</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/igraph/rigraph/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fitting a power-law distribution function to discrete data</h1>
      <small class="dont-index">Source: <a href="https://github.com/igraph/rigraph/blob/main/R/fit.R" class="external-link"><code>R/fit.R</code></a></small>
      <div class="d-none name"><code>fit_power_law.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>fit_power_law()</code> fits a power-law distribution to a data set.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_power_law</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  xmin <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  force.continuous <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  implementation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"plfit"</span>, <span class="st">"R.mle"</span>, <span class="st">"plfit.p"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>The data to fit, a numeric vector. For implementation
‘<code>R.mle</code>’ the data must be integer values. For the
‘<code>plfit</code>’ implementation non-integer values might be present and
then a continuous power-law distribution is fitted.</p></dd>


<dt id="arg-xmin">xmin<a class="anchor" aria-label="anchor" href="#arg-xmin"></a></dt>
<dd><p>Numeric scalar, or <code>NULL</code>. The lower bound for fitting the
power-law. If <code>NULL</code>, the smallest value in <code>x</code> will be used for
the ‘<code>R.mle</code>’ implementation, and its value will be
automatically determined for the ‘<code>plfit</code>’ implementation. This
argument makes it possible to fit only the tail of the distribution.</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>Numeric scalar. The initial value of the exponent for the
minimizing function, for the ‘<code>R.mle</code>’ implementation. Usually
it is safe to leave this untouched.</p></dd>


<dt id="arg-force-continuous">force.continuous<a class="anchor" aria-label="anchor" href="#arg-force-continuous"></a></dt>
<dd><p>Logical scalar. Whether to force a continuous
distribution for the ‘<code>plfit</code>’ implementation, even if the
sample vector contains integer values only (by chance). If this argument is
false, igraph will assume a continuous distribution if at least one sample
is non-integer and assume a discrete distribution otherwise.</p></dd>


<dt id="arg-implementation">implementation<a class="anchor" aria-label="anchor" href="#arg-implementation"></a></dt>
<dd><p>Character scalar. Which implementation to use. See
details below.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments, passed to the maximum likelihood
optimizing function, <code><a href="https://rdrr.io/r/stats4/mle.html" class="external-link">stats4::mle()</a></code>, if the ‘<code>R.mle</code>’
implementation is chosen. It is ignored by the ‘<code>plfit</code>’
implementation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Depends on the <code>implementation</code> argument. If it is
‘<code>R.mle</code>’, then an object with class ‘<code>mle</code>’. It can
be used to calculate confidence intervals and log-likelihood. See
<code><a href="https://rdrr.io/r/stats4/mle-class.html" class="external-link">stats4::mle-class()</a></code> for details.</p>
<p>If <code>implementation</code> is ‘<code>plfit</code>’ or ‘<code>plfit.p</code>’, then the result is a
named list with entries:</p>
<dl><dt>continuous</dt>
<dd><p>Logical scalar, whether the
fitted power-law distribution was continuous or discrete.</p></dd>

<dt>alpha</dt>
<dd><p>Numeric scalar, the exponent of the fitted power-law distribution.</p></dd>

<dt>xmin</dt>
<dd><p>Numeric scalar, the minimum value from which the
power-law distribution was fitted. In other words, only the values larger
than <code>xmin</code> were used from the input vector.</p></dd>

<dt>logLik</dt>
<dd><p>Numeric scalar, the log-likelihood of the fitted parameters.</p></dd>

<dt>KS.stat</dt>
<dd><p>Numeric scalar, the test statistic of a Kolmogorov-Smirnov test
that compares the fitted distribution with the input vector.
Smaller scores denote better fit.</p></dd>

<dt>KS.p</dt>
<dd><p>Only for <code>plfit.p</code>. Numeric scalar, the p-value of the Kolmogorov-Smirnov
test. Small p-values (less than 0.05) indicate that the test rejected the
hypothesis that the original data could have been drawn from the fitted
power-law distribution.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function fits a power-law distribution to a vector containing samples
from a distribution (that is assumed to follow a power-law of course). In a
power-law distribution, it is generally assumed that \(P(X=x)\) is
proportional to \(x^{-\alpha}\), where \(x\) is a positive
number and \(\alpha\) is greater than 1. In many real-world cases,
the power-law behaviour kicks in only above a threshold value
\(x_\text{min}\). The goal of this function is to determine
\(\alpha\) if \(x_\text{min}\) is given, or to determine
\(x_\text{min}\) and the corresponding value of \(\alpha\).</p>
<p><code>fit_power_law()</code> provides two maximum likelihood implementations.  If
the <code>implementation</code> argument is ‘<code>R.mle</code>’, then the BFGS
optimization (see <code><a href="https://rdrr.io/r/stats4/mle.html" class="external-link">stats4::mle()</a></code>) algorithm is applied.  The additional
arguments are passed to the mle function, so it is possible to change the
optimization method and/or its parameters.  This implementation can
<em>not</em> to fit the \(x_\text{min}\) argument, so use the
‘<code>plfit</code>’ implementation if you want to do that.</p>
<p>The ‘<code>plfit</code>’ implementation also uses the maximum likelihood
principle to determine \(\alpha\) for a given \(x_\text{min}\);
When \(x_\text{min}\) is not given in advance, the algorithm will attempt
to find its optimal value for which the \(p\)-value of a Kolmogorov-Smirnov
test between the fitted distribution and the original sample is the largest.
The function uses the method of Clauset, Shalizi and Newman to calculate the
parameters of the fitted distribution. See references below for the details.</p>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p>Pass ‘<code>plfit.p</code>’ instead of ‘<code>plfit</code>’ as the <code>implementation</code>
argument to include the p-value in the output.
This is not returned by default because the computation may be slow.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Power laws, Pareto distributions and Zipf's law, M. E. J.
Newman, <em>Contemporary Physics</em>, 46, 323-351, 2005.</p>
<p>Aaron Clauset, Cosma R .Shalizi and Mark E.J. Newman: Power-law
distributions in empirical data. SIAM Review 51(4):661-703, 2009.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats4/mle.html" class="external-link">stats4::mle()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Tamas Nepusz <a href="mailto:ntamas@gmail.com">ntamas@gmail.com</a> and Gabor Csardi
<a href="mailto:csardi.gabor@gmail.com">csardi.gabor@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This should approximately yield the correct exponent 3</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="sample_pa.html">sample_pa</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span> <span class="co"># increase this number to have a better estimate</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="degree.html">degree</a></span><span class="op">(</span><span class="va">g</span>, mode <span class="op">=</span> <span class="st">"in"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">fit_power_law</span><span class="op">(</span><span class="va">d</span> <span class="op">+</span> <span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">fit_power_law</span><span class="op">(</span><span class="va">d</span> <span class="op">+</span> <span class="fl">1</span>, <span class="fl">10</span>, implementation <span class="op">=</span> <span class="st">"R.mle"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit1</span><span class="op">$</span><span class="va">alpha</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.567177</span>
<span class="r-in"><span><span class="fu">stats4</span><span class="fu">::</span><span class="fu">coef</span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    alpha </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.566887 </span>
<span class="r-in"><span><span class="va">fit1</span><span class="op">$</span><span class="va">logLik</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -58.53319</span>
<span class="r-in"><span><span class="fu">stats4</span><span class="fu">::</span><span class="fu">logLik</span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'log Lik.' -58.53288 (df=1)</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gaborcsardi" class="external-link">Gábor Csárdi</a>, <a href="https://github.com/ntamas" class="external-link">Tamás Nepusz</a>, <a href="https://www.traag.net/" class="external-link">Vincent Traag</a>, <a href="http://szhorvat.net/" class="external-link">Szabolcs Horvát</a>, <a href="https://fabilab.org/pages/people.html" class="external-link">Fabio Zanini</a>, <a href="https://github.com/GroteGnoom" class="external-link">Daniel Noom</a>, <a href="https://krlmlr.info/" class="external-link">Kirill Müller</a>, Chan Zuckerberg Initiative.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

