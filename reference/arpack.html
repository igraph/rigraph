<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>ARPACK eigenvector calculation — arpack_defaults • igraph</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ARPACK eigenvector calculation — arpack_defaults"><meta name="description" content="Interface to the ARPACK library for calculating eigenvectors of sparse
matrices"><meta property="og:description" content="Interface to the ARPACK library for calculating eigenvectors of sparse
matrices"><meta property="og:image" content="https://r.igraph.org/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">igraph</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.3.9059</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-get-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Get started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-get-started"><li><a class="dropdown-item" href="../articles/igraph.html">Intro</a></li>
    <li><a class="dropdown-item" href="../articles/igraph_ES.html">Intro (Español)</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/installation-troubleshooting.html">Installation FAQs</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">All articles</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/igraph/rigraph/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>ARPACK eigenvector calculation</h1>
      <small class="dont-index">Source: <a href="https://github.com/igraph/rigraph/blob/main/R/centrality.R" class="external-link"><code>R/centrality.R</code></a></small>
      <div class="d-none name"><code>arpack.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Interface to the ARPACK library for calculating eigenvectors of sparse
matrices</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">arpack_defaults</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">arpack</span><span class="op">(</span></span>
<span>  <span class="va">func</span>,</span>
<span>  extra <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sym <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  options <span class="op">=</span> <span class="fu">arpack_defaults</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  env <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  complex <span class="op">=</span> <span class="op">!</span><span class="va">sym</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-func">func<a class="anchor" aria-label="anchor" href="#arg-func"></a></dt>
<dd><p>The function to perform the matrix-vector multiplication. ARPACK
requires to perform these by the user. The function gets the vector \(x\)
as the first argument, and it should return \(Ax\), where \(A\) is the
“input matrix”. (The input matrix is never given explicitly.) The
second argument is <code>extra</code>.</p></dd>


<dt id="arg-extra">extra<a class="anchor" aria-label="anchor" href="#arg-extra"></a></dt>
<dd><p>Extra argument to supply to <code>func</code>.</p></dd>


<dt id="arg-sym">sym<a class="anchor" aria-label="anchor" href="#arg-sym"></a></dt>
<dd><p>Logical scalar, whether the input matrix is symmetric. Always
supply <code>TRUE</code> here if it is, since it can speed up the computation.</p></dd>


<dt id="arg-options">options<a class="anchor" aria-label="anchor" href="#arg-options"></a></dt>
<dd><p>Options to ARPACK, a named list to overwrite some of the
default option values. See details below.</p></dd>


<dt id="arg-env">env<a class="anchor" aria-label="anchor" href="#arg-env"></a></dt>
<dd><p>The environment in which <code>func</code> will be evaluated.</p></dd>


<dt id="arg-complex">complex<a class="anchor" aria-label="anchor" href="#arg-complex"></a></dt>
<dd><p>Whether to convert the eigenvectors returned by ARPACK into R
complex vectors. By default this is not done for symmetric problems (these
only have real eigenvectors/values), but only non-symmetric ones. If you
have a non-symmetric problem, but you're sure that the results will be real,
then supply <code>FALSE</code> here.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A named list with the following members:</p>
<dl><dt>values</dt>
<dd><p>Numeric
vector, the desired eigenvalues.</p></dd>
 <dt>vectors</dt>
<dd><p>Numeric matrix, the desired
eigenvectors as columns. If <code>complex=TRUE</code> (the default for
non-symmetric problems), then the matrix is complex.</p></dd>
 <dt>options</dt>
<dd><p>A named
list with the supplied <code>options</code> and some information about the
performed calculation, including an ARPACK exit code. See the details above.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>ARPACK is a library for solving large scale eigenvalue problems.  The
package is designed to compute a few eigenvalues and corresponding
eigenvectors of a general \(n\) by \(n\) matrix \(A\). It is most
appropriate for large sparse or structured matrices \(A\) where structured
means that a matrix-vector product <code>w &lt;- Av</code> requires order \(n\)
rather than the usual order \(n^2\) floating point operations.</p>
<p>This function is an interface to ARPACK. igraph does not contain all ARPACK
routines, only the ones dealing with symmetric and non-symmetric eigenvalue
problems using double precision real numbers.</p>
<p>The eigenvalue calculation in ARPACK (in the simplest case) involves the
calculation of the \(Av\) product where \(A\) is the matrix we work with
and \(v\) is an arbitrary vector. The function supplied in the <code>fun</code>
argument is expected to perform this product. If the product can be done
efficiently, e.g. if the matrix is sparse, then <code>arpack()</code> is usually
able to calculate the eigenvalues very quickly.</p>
<p>The <code>options</code> argument specifies what kind of calculation to perform.
It is a list with the following members, they correspond directly to ARPACK
parameters. On input it has the following fields:</p><dl><dt>bmat</dt>
<dd><p>Character constant, possible values: ‘<code>I</code>’, standard
eigenvalue problem, \(Ax=\lambda x\); and ‘<code>G</code>’,
generalized eigenvalue problem, \(Ax=\lambda B x\).
Currently only ‘<code>I</code>’ is supported.</p></dd>
 <dt>n</dt>
<dd><p>Numeric scalar. The
dimension of the eigenproblem. You only need to set this if you call
<code>arpack()</code> directly. (I.e. not needed for
<code><a href="eigen_centrality.html">eigen_centrality()</a></code>, <code><a href="page_rank.html">page_rank()</a></code>, etc.)</p></dd>

<dt>which</dt>
<dd><p>Specify which eigenvalues/vectors to compute, character
constant with exactly two characters.</p>
<p>Possible values for symmetric input matrices:</p><dl><dt>"LA"</dt>
<dd><p>Compute <code>nev</code> largest (algebraic) eigenvalues.</p></dd>

<dt>"SA"</dt>
<dd><p>Compute <code>nev</code> smallest (algebraic)
eigenvalues.</p></dd>
 <dt>"LM"</dt>
<dd><p>Compute <code>nev</code> largest (in
magnitude) eigenvalues.</p></dd>
 <dt>"SM"</dt>
<dd><p>Compute <code>nev</code> smallest
(in magnitude) eigenvalues.</p></dd>
 <dt>"BE"</dt>
<dd><p>Compute <code>nev</code>
eigenvalues, half from each end of the spectrum. When <code>nev</code> is odd,
compute one more from the high end than from the low end.</p></dd>

</dl><p>Possible values for non-symmetric input matrices:</p><dl><dt>"LM"</dt>
<dd><p>Compute <code>nev</code> eigenvalues of largest
magnitude.</p></dd>
 <dt>"SM"</dt>
<dd><p>Compute <code>nev</code> eigenvalues of
smallest magnitude.</p></dd>
 <dt>"LR"</dt>
<dd><p>Compute <code>nev</code> eigenvalues
of largest real part.</p></dd>
 <dt>"SR"</dt>
<dd><p>Compute <code>nev</code>
eigenvalues of smallest real part.</p></dd>
 <dt>"LI"</dt>
<dd><p>Compute
<code>nev</code> eigenvalues of largest imaginary part.</p></dd>

<dt>"SI"</dt>
<dd><p>Compute <code>nev</code> eigenvalues of smallest imaginary
part.</p></dd>

</dl><p>This parameter is sometimes overwritten by the various functions, e.g.
<code><a href="page_rank.html">page_rank()</a></code> always sets ‘<code>LM</code>’.</p></dd>

<dt>nev</dt>
<dd><p>Numeric scalar. The number of eigenvalues to be computed.</p></dd>

<dt>tol</dt>
<dd><p>Numeric scalar. Stopping criterion: the relative accuracy of the
Ritz value is considered acceptable if its error is less than <code>tol</code>
times its estimated value. If this is set to zero then machine precision is
used.</p></dd>
 <dt>ncv</dt>
<dd><p>Number of Lanczos vectors to be generated.</p></dd>

<dt>ldv</dt>
<dd><p>Numberic scalar. It should be set to zero in the current
implementation.</p></dd>
 <dt>ishift</dt>
<dd><p>Either zero or one. If zero then the shifts
are provided by the user via reverse communication. If one then exact shifts
with respect to the reduced tridiagonal matrix \(T\).  Please always set
this to one.</p></dd>
 <dt>maxiter</dt>
<dd><p>Maximum number of Arnoldi update iterations
allowed.</p></dd>
 <dt>nb</dt>
<dd><p>Blocksize to be used in the recurrence. Please always
leave this on the default value, one.</p></dd>
 <dt>mode</dt>
<dd><p>The type of the
eigenproblem to be solved.  Possible values if the input matrix is
symmetric:</p><dl><dt>1</dt>
<dd><p>\(Ax=\lambda x\), \(A\) is
symmetric.</p></dd>
 <dt>2</dt>
<dd><p>\(Ax=\lambda Mx\), \(A\) is
symmetric, \(M\) is symmetric positive definite.</p></dd>
 <dt>3</dt>
<dd><p>\(Kx=\lambda
Mx\), \(K\) is symmetric, \(M\) is symmetric positive
semi-definite.</p></dd>
 <dt>4</dt>
<dd><p>\(Kx=\lambda KGx\), \(K\) is
symmetric positive semi-definite, \(KG\) is symmetric indefinite.</p></dd>

<dt>5</dt>
<dd><p>\(Ax=\lambda Mx\), \(A\) is symmetric, \(M\)
is symmetric positive semi-definite. (Cayley transformed mode.)</p></dd>

</dl><p>Please
note that only <code>mode==1</code> was tested and other values might not work
properly.</p>
<p>Possible values if the input matrix is not symmetric:</p><dl><dt>1</dt>
<dd><p>\(Ax=\lambda x\).</p></dd>
 <dt>2</dt>
<dd><p>\(Ax=\lambda
Mx\), \(M\) is symmetric positive definite.</p></dd>

<dt>3</dt>
<dd><p>\(Ax=\lambda Mx\), \(M\) is symmetric
semi-definite.</p></dd>
 <dt>4</dt>
<dd><p>\(Ax=\lambda Mx\), \(M\) is
symmetric semi-definite.</p></dd>

</dl><p>Please note that only <code>mode==1</code> was tested
and other values might not work properly.</p></dd>
 <dt>start</dt>
<dd><p>Not used
currently. Later it be used to set a starting vector.</p></dd>
 <dt>sigma</dt>
<dd><p>Not used
currently.</p></dd>
 <dt>sigmai</dt>
<dd><p>Not use currently.</p></dd>


On output the following additional fields are added:


</dl><p>Please see the ARPACK documentation for
additional details.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>D.C. Sorensen, Implicit Application of Polynomial Filters in a
k-Step Arnoldi Method. <em>SIAM J. Matr. Anal. Apps.</em>, 13 (1992), pp
357-385.</p>
<p>R.B. Lehoucq, Analysis and Implementation of an Implicitly Restarted Arnoldi
Iteration. <em>Rice University Technical Report</em> TR95-13, Department of
Computational and Applied Mathematics.</p>
<p>B.N. Parlett &amp; Y. Saad, Complex Shift and Invert Strategies for Real
Matrices. <em>Linear Algebra and its Applications</em>, vol 88/89, pp 575-595,
(1987).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="eigen_centrality.html">eigen_centrality()</a></code>, <code><a href="page_rank.html">page_rank()</a></code>,
<code><a href="hub_score.html">hub_score()</a></code>, <code><a href="cluster_leading_eigen.html">cluster_leading_eigen()</a></code> are some of the
functions in igraph that use ARPACK.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Rich Lehoucq, Kristi Maschhoff, Danny Sorensen, Chao Yang for
ARPACK, Gabor Csardi <a href="mailto:csardi.gabor@gmail.com">csardi.gabor@gmail.com</a> for the R interface.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Identity matrix</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">extra</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="va">x</span></span></span>
<span class="r-in"><span><span class="fu">arpack</span><span class="op">(</span><span class="va">f</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, nev <span class="op">=</span> <span class="fl">2</span>, ncv <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, sym <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $vectors</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]         [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] -0.3726998  0.112735486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  0.1195827  0.041517695</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  0.4062664 -0.421475667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] -0.4452969 -0.709645619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.3098338  0.177672414</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  0.1653131 -0.125415897</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -0.1946057  0.482549613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  0.4619532  0.006154024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -0.2346540  0.121470373</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]  0.2319333 -0.096874464</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$bmat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "I"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$which</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "XX"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$nev</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$tol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$ncv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$ldv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$ishift</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$maxiter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$nb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$mode</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$start</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$sigma</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$sigmai</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$info</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$iter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$nconv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$numop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$numopb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$numreo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Graph laplacian of a star graph (undirected), n&gt;=2</span></span></span>
<span class="r-in"><span><span class="co"># Note that this is a linear operation</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">extra</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span></span></span>
<span class="r-in"><span>  <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="va">y</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">arpack</span><span class="op">(</span><span class="va">f</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, nev <span class="op">=</span> <span class="fl">1</span>, ncv <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, sym <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $vectors</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] -0.9486833  0.1054093  0.1054093  0.1054093  0.1054093  0.1054093</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7]  0.1054093  0.1054093  0.1054093  0.1054093</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$bmat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "I"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$which</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "XX"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$nev</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$tol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$ncv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$ldv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$ishift</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$maxiter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$nb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$mode</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$start</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$sigma</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$sigmai</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$info</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$iter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$nconv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$numop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$numopb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $options$numreo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># double check</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="fu"><a href="laplacian_matrix.html">laplacian_matrix</a></span><span class="op">(</span><span class="fu"><a href="make_star.html">make_star</a></span><span class="op">(</span><span class="fl">10</span>, mode <span class="op">=</span> <span class="st">"undirected"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eigen() decomposition</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1.000000e+01 1.000000e+00 1.000000e+00 1.000000e+00 1.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] 1.000000e+00 1.000000e+00 1.000000e+00 1.000000e+00 3.552714e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $vectors</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]          [,2]         [,3]          [,4]          [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  0.9486833  0.000000e+00  0.000000000  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] -0.1054093  9.251859e-18  0.000000000 -9.251859e-18  1.850372e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] -0.1054093 -9.316303e-02  0.079217213 -5.526928e-02 -5.860537e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] -0.1054093  9.295069e-01  0.020878444 -5.681485e-02  2.420873e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] -0.1054093 -1.772059e-01 -0.072634120 -1.521102e-01  1.990548e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -0.1054093 -1.772059e-01  0.014765896  3.109043e-01  1.456789e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -0.1054093 -1.246177e-01  0.008447773  6.043444e-02  8.117572e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -0.1054093 -6.376015e-02 -0.659513765  4.360577e-01 -3.697494e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -0.1054093 -1.772059e-01 -0.124196522 -7.876367e-01 -2.016864e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -0.1054093 -1.163484e-01  0.733035080  2.444346e-01 -3.715091e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                [,6]        [,7]       [,8]          [,9]      [,10]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  0.000000e+00  0.00000000  0.0000000  0.000000e+00 -0.3162278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  9.251859e-18  0.00000000  0.9428090  6.476301e-17 -0.3162278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  3.877514e-02  0.07938499 -0.1178511  9.196470e-01 -0.3162278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  2.633343e-02  0.05841931 -0.1178511 -5.158318e-02 -0.3162278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  8.820081e-01 -0.01683834 -0.1178511 -1.912244e-01 -0.3162278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -1.516578e-01  0.81604496 -0.1178511 -1.912244e-01 -0.3162278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -1.927091e-01 -0.39623153 -0.1178511 -5.158318e-02 -0.3162278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -1.420878e-01 -0.29370999 -0.1178511 -5.158318e-02 -0.3162278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -3.596255e-01  0.03503021 -0.1178511 -1.912244e-01 -0.3162278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -1.010365e-01 -0.28209962 -0.1178511 -1.912244e-01 -0.3162278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## First three eigenvalues of the adjacency matrix of a graph</span></span></span>
<span class="r-in"><span><span class="co">## We need the 'Matrix' package for this</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://Matrix.R-forge.R-project.org" class="external-link">Matrix</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="sample_gnp.html">sample_gnp</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">5</span> <span class="op">/</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="as_adjacency_matrix.html">as_adj</a></span><span class="op">(</span><span class="va">g</span>, sparse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">f2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">extra</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"."</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">M</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="va">baev</span> <span class="op">&lt;-</span> <span class="fu">arpack</span><span class="op">(</span><span class="va">f2</span>, sym <span class="op">=</span> <span class="cn">TRUE</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    n <span class="op">=</span> <span class="fu"><a href="gorder.html">vcount</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>, nev <span class="op">=</span> <span class="fl">3</span>, ncv <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span>    which <span class="op">=</span> <span class="st">"LM"</span>, maxiter <span class="op">=</span> <span class="fl">2000</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: Matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .....................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gaborcsardi" class="external-link">Gábor Csárdi</a>, <a href="https://github.com/ntamas" class="external-link">Tamás Nepusz</a>, <a href="https://www.traag.net/" class="external-link">Vincent Traag</a>, <a href="http://szhorvat.net/" class="external-link">Szabolcs Horvát</a>, <a href="https://fabilab.org/pages/people.html" class="external-link">Fabio Zanini</a>, <a href="https://github.com/GroteGnoom" class="external-link">Daniel Noom</a>, <a href="https://krlmlr.info/" class="external-link">Kirill Müller</a>, Chan Zuckerberg Initiative.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

