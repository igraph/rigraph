<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Random graph with given expected degrees — sample_chung_lu • igraph</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Random graph with given expected degrees — sample_chung_lu"><meta name="description" content="
The Chung-Lu model is useful for generating random graphs with fixed expected
degrees. This function implements both the original model of Chung and Lu, as
well as some additional variants with useful properties."><meta property="og:description" content="
The Chung-Lu model is useful for generating random graphs with fixed expected
degrees. This function implements both the original model of Chung and Lu, as
well as some additional variants with useful properties."><meta property="og:image" content="https://r.igraph.org/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">igraph</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.3.9059</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-get-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Get started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-get-started"><li><a class="dropdown-item" href="../articles/igraph.html">Intro</a></li>
    <li><a class="dropdown-item" href="../articles/igraph_ES.html">Intro (Español)</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/installation-troubleshooting.html">Installation FAQs</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">All articles</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/igraph/rigraph/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Random graph with given expected degrees</h1>
      <small class="dont-index">Source: <a href="https://github.com/igraph/rigraph/blob/main/R/games.R" class="external-link"><code>R/games.R</code></a></small>
      <div class="d-none name"><code>sample_chung_lu.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p>The Chung-Lu model is useful for generating random graphs with fixed expected
degrees. This function implements both the original model of Chung and Lu, as
well as some additional variants with useful properties.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sample_chung_lu</span><span class="op">(</span></span>
<span>  <span class="va">out.weights</span>,</span>
<span>  in.weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  loops <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  variant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"original"</span>, <span class="st">"maxent"</span>, <span class="st">"nr"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">chung_lu</span><span class="op">(</span></span>
<span>  <span class="va">out.weights</span>,</span>
<span>  in.weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  loops <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  variant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"original"</span>, <span class="st">"maxent"</span>, <span class="st">"nr"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-out-weights">out.weights<a class="anchor" aria-label="anchor" href="#arg-out-weights"></a></dt>
<dd><p>A vector of non-negative vertex weights (or out-weights).
In sparse graphs, these will be approximately equal to the expected
(out-)degrees.</p></dd>


<dt id="arg-in-weights">in.weights<a class="anchor" aria-label="anchor" href="#arg-in-weights"></a></dt>
<dd><p>A vector of non-negative in-weights, approximately equal to
the expected in-degrees in sparse graphs. May be set to <code>NULL</code>, in
which case undirected graphs are generated.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>These dots are for future extensions and must be empty.</p></dd>


<dt id="arg-loops">loops<a class="anchor" aria-label="anchor" href="#arg-loops"></a></dt>
<dd><p>Logical, whether to allow the creation of self-loops. Since
vertex pairs are connected independently, setting this to <code>FALSE</code> is
equivalent to simply discarding self-loops from an existing loopy Chung-Lu
graph.</p></dd>


<dt id="arg-variant">variant<a class="anchor" aria-label="anchor" href="#arg-variant"></a></dt>
<dd><p>The model variant to sample from, with different definitions
of the connection probability between vertices \(i\) and \(j\). Given
\(q_{ij} = \frac{w_i w_j}{S}\), the following
formulations are available:</p><dl><dt>“original”</dt>
<dd><p>the original Chung-Lu model, \(p_{ij} = \min(q_{ij}, 1)\).</p></dd>

<dt>“maxent”</dt>
<dd><p>maximum entropy model with fixed expected degrees,
\(p_{ij} = \frac{q_{ij}}{1 + q_{ij}}\).</p></dd>

<dt>“nr”</dt>
<dd><p>Norros and Reittu's model, \(p_{ij} = 1 - \exp(-q_{ij})\).</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An igraph graph.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In the original Chung-Lu model, each pair of vertices \(i\) and \(j\) is
connected with independent probability
$$p_{ij} = \frac{w_i w_j}{S},$$
where \(w_i\) is a weight associated with vertex \(i\) and
$$S = \sum_k w_k$$
is the sum of weights. In the directed variant, vertices have both
out-weights, \(w^\text{out}\), and in-weights,
\(w^\text{in}\), with equal sums,
$$S = \sum_k w^\text{out}_k = \sum_k w^\text{in}_k.$$
The connection probability between \(i\) and \(j\) is
$$p_{ij} = \frac{w^\text{out}_i w^\text{in}_j.}{S}$$</p>
<p>This model is commonly used to create random graphs with a fixed
<em>expected</em> degree sequence. The expected degree of vertex \(i\) is
approximately equal to the weight \(w_i\). Specifically, if the graph is
directed and self-loops are allowed, then the expected out- and in-degrees
are precisely \(w^\text{out}\) and \(w^\text{in}\). If
self-loops are disallowed, then the expected out- and in-degrees are
\(\frac{w^\text{out} (S - w^\text{in})}{S}\)
and
\(\frac{w^\text{in} (S - w^\text{out})}{S}\),
respectively. If the graph is undirected, then the expected degrees with and
without self-loops are
\(\frac{w (S + w)}{S}\)
and
\(\frac{w (S - w)}{S}\),
respectively.</p>
<p>A limitation of the original Chung-Lu model is that when some of the weights
are large, the formula for \(p_{ij}\) yields values larger than 1.
Chung
and Lu's original paper excludes the use of such weights. When
\(p_{ij} &gt; 1\), this function simply issues a warning and creates
a connection between \(i\) and \(j\). However, in this case the expected
degrees will no longer relate to the weights in the manner stated above. Thus,
the original Chung-Lu model cannot produce certain (large) expected degrees.</p>
<p>To overcome this limitation, this function implements additional variants of
the model, with modified expressions for the connection probability
\(p_{ij}\) between vertices \(i\) and \(j\). Let
\(q_{ij} = \frac{w_i w_j}{S}\), or
\(q_{ij} = \frac{w^\text{out}_i w^\text{in}_j}{S}\)
in the directed case. All model variants become equivalent in the limit of sparse
graphs where \(q_{ij}\) approaches zero. In the original Chung-Lu model,
selectable by setting <code>variant</code> to “original”, \(p_{ij} =
\min(q_{ij}, 1)\). The “maxent” variant,
sometimes referred to as the generalized random graph, uses \(p_{ij} =
\frac{q_{ij}}{1 + q_{ij}}\), and is equivalent to a
maximum entropy model (i.e., exponential random graph model) with a
constraint on expected degrees;
see Park and Newman (2004), Section B, setting \(\exp(-\Theta_{ij}) =
\frac{w_i w_j}{S}\). This model is also discussed
by Britton, Deijfen, and Martin-Löf (2006). By virtue of being a
degree-constrained maximum entropy model, it generates graphs with the same
degree sequence with the same probability. A third variant can be requested
with “nr”, and uses \(p_{ij} = 1 - \exp(-q_{ij})\). This is the underlying simple graph of a multigraph model
introduced by Norros and Reittu (2006). For a discussion of these three model
variants, see Section 16.4 of Bollobás, Janson, Riordan (2007), as well as
Van Der Hofstad (2013).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Chung, F., and Lu, L. (2002). Connected components in a random
graph with given degree sequences. Annals of Combinatorics, 6, 125-145.
<a href="https://doi.org/10.1007/PL00012580" class="external-link">doi:10.1007/PL00012580</a></p>
<p>Miller, J. C., and Hagberg, A. (2011). Efficient Generation of Networks
with Given Expected Degrees. <a href="https://doi.org/10.1007/978-3-642-21286-4_10" class="external-link">doi:10.1007/978-3-642-21286-4_10</a></p>
<p>Park, J., and Newman, M. E. J. (2004). Statistical mechanics of networks.
Physical Review E, 70, 066117. <a href="https://doi.org/10.1103/PhysRevE.70.066117" class="external-link">doi:10.1103/PhysRevE.70.066117</a></p>
<p>Britton, T., Deijfen, M., and Martin-Löf, A. (2006). Generating Simple
Random Graphs with Prescribed Degree Distribution. Journal of Statistical
Physics, 124, 1377-1397. <a href="https://doi.org/10.1007/s10955-006-9168-x" class="external-link">doi:10.1007/s10955-006-9168-x</a></p>
<p>Norros, I., and Reittu, H. (2006). On a conditionally Poissonian graph
process. Advances in Applied Probability, 38, 59-75.
<a href="https://doi.org/10.1239/aap/1143936140" class="external-link">doi:10.1239/aap/1143936140</a></p>
<p>Bollobás, B., Janson, S., and Riordan, O. (2007). The phase transition in
inhomogeneous random graphs. Random Structures &amp; Algorithms, 31, 3-122.
<a href="https://doi.org/10.1002/rsa.20168" class="external-link">doi:10.1002/rsa.20168</a></p>
<p>Van Der Hofstad, R. (2013). Critical behavior in inhomogeneous random
graphs. Random Structures &amp; Algorithms, 42, 480-508.
<a href="https://doi.org/10.1002/rsa.20450" class="external-link">doi:10.1002/rsa.20450</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="sample_fitness.html">sample_fitness()</a></code> implements a similar model with a sharp
constraint on the number of edges. <code><a href="sample_degseq.html">sample_degseq()</a></code> samples random graphs
with sharply specified degrees. <code><a href="sample_gnp.html">sample_gnp()</a></code> creates random graphs with a
fixed connection probability \(p\) between all vertex pairs.</p>
<p>Random graph models (games)
<code><a href="erdos.renyi.game.html">erdos.renyi.game</a>()</code>,
<code><a href="sample_.html">sample_</a>()</code>,
<code><a href="sample_bipartite.html">sample_bipartite</a>()</code>,
<code><a href="sample_correlated_gnp.html">sample_correlated_gnp</a>()</code>,
<code><a href="sample_correlated_gnp_pair.html">sample_correlated_gnp_pair</a>()</code>,
<code><a href="sample_degseq.html">sample_degseq</a>()</code>,
<code><a href="sample_dot_product.html">sample_dot_product</a>()</code>,
<code><a href="sample_fitness.html">sample_fitness</a>()</code>,
<code><a href="sample_fitness_pl.html">sample_fitness_pl</a>()</code>,
<code><a href="sample_forestfire.html">sample_forestfire</a>()</code>,
<code><a href="sample_gnm.html">sample_gnm</a>()</code>,
<code><a href="sample_gnp.html">sample_gnp</a>()</code>,
<code><a href="sample_grg.html">sample_grg</a>()</code>,
<code><a href="sample_growing.html">sample_growing</a>()</code>,
<code><a href="sample_hierarchical_sbm.html">sample_hierarchical_sbm</a>()</code>,
<code><a href="sample_islands.html">sample_islands</a>()</code>,
<code><a href="sample_k_regular.html">sample_k_regular</a>()</code>,
<code><a href="sample_last_cit.html">sample_last_cit</a>()</code>,
<code><a href="sample_pa.html">sample_pa</a>()</code>,
<code><a href="sample_pa_age.html">sample_pa_age</a>()</code>,
<code><a href="sample_pref.html">sample_pref</a>()</code>,
<code><a href="sample_sbm.html">sample_sbm</a>()</code>,
<code><a href="sample_smallworld.html">sample_smallworld</a>()</code>,
<code><a href="sample_traits_callaway.html">sample_traits_callaway</a>()</code>,
<code><a href="sample_tree.html">sample_tree</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="related-documentation-in-the-c-library">Related documentation in the C library<a class="anchor" aria-label="anchor" href="#related-documentation-in-the-c-library"></a></h2>
    <p><a href="https://igraph.org/c/html/latest/igraph-Generators.html#igraph_chung_lu_game" class="external-link"><code>igraph_chung_lu_game()</code></a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">sample_chung_lu</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums-methods.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fl">100</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="degree.html">degree</a></span><span class="op">(</span><span class="fu">sample_chung_lu</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>, mode <span class="op">=</span> <span class="st">"out"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.17 2.94 1.96 0.89</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums-methods.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fl">100</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="degree.html">degree</a></span><span class="op">(</span><span class="fu">sample_chung_lu</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, variant <span class="op">=</span> <span class="st">"maxent"</span><span class="op">)</span>, mode<span class="op">=</span><span class="st">'out'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.90 1.71 1.32 0.84</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gaborcsardi" class="external-link">Gábor Csárdi</a>, <a href="https://github.com/ntamas" class="external-link">Tamás Nepusz</a>, <a href="https://www.traag.net/" class="external-link">Vincent Traag</a>, <a href="http://szhorvat.net/" class="external-link">Szabolcs Horvát</a>, <a href="https://fabilab.org/pages/people.html" class="external-link">Fabio Zanini</a>, <a href="https://github.com/GroteGnoom" class="external-link">Daniel Noom</a>, <a href="https://krlmlr.info/" class="external-link">Kirill Müller</a>, Chan Zuckerberg Initiative.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

