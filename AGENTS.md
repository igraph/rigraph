# AI Agent Development Guidelines for igraph

> **Note**: For GitHub Copilot-specific instructions, see
> [`.github/copilot-instructions.md`](https://r.igraph.org/copilot-instructions.md).

## Project Overview

igraph is an R package for network analysis and graph theory. It
provides routines for simple graphs and network analysis, handles large
graphs efficiently, and includes functions for generating random and
regular graphs, graph visualization, centrality methods, and much more.

## Key Technologies

- **Language**: R with C/C++ backend (uses the igraph C library)
- **Testing**: testthat framework
- **Documentation**: roxygen2 with Markdown syntax
- **Code Formatting**: air (R formatting tool)
- **Build System**: R CMD, devtools, Makefile
- **Code Generation**: Stimulus framework (see `tools/README.md`)

## Development Setup

### Installation and Dependencies

``` r
# Install all dependencies
pak::pak()
# Install build dependencies
pak::pak(dependencies = "Config/Needs/build")
```

### Install and run R

- When run on GitHub Actions, assume that R, the package in its current
  state and all dependencies are installed.
- Only install new packages when needed for implementing new features or
  tests.
- Run `R -q -e 'testthat::test_local(reporter = "check")'` to execute
  tests as a final step.

### Building and Testing

- Load package for development:
  [`pkgload::load_all()`](https://pkgload.r-lib.org/reference/load_all.html)
- Run tests: `testthat::test_local(reporter = "check")`
- Build package:
  [`devtools::build()`](https://devtools.r-lib.org/reference/build.html)
- Check package:
  [`devtools::check()`](https://devtools.r-lib.org/reference/check.html)
- Update documentation:
  [`devtools::document()`](https://devtools.r-lib.org/reference/document.html)
- Format code: `air format .`

## Code Style and Documentation

### PR and Commit Style

- IMPORTANT: PR titles end up in `NEWS.md` grouped by conventional
  commit label. PRs and commits use the conventional commit style with
  backticks for code references such as `function_call()`
- PRs are generally squashed, a clean history within a PR is not
  necessary

### Comment Style

- Prefer expressive code over comments where possible
- Add comments to utility functions that cannot be made immediately
  obvious
- Focus comments on explaining the “why” and “how”, the “what” should be
  clear from the code itself
- Use line breaks after each sentence in multi-sentence comments

### R Code Conventions

- Follow the [tidyverse style guide](https://style.tidyverse.org)
- Use `snake_case` for new functions
- Use explicit package prefixes (e.g.,
  [`withr::local_db_connection()`](https://withr.r-lib.org/reference/with_db_connection.html))
  for clarity
- Maintain consistent indentation (2 spaces) and spacing patterns
- Use meaningful variable names that reflect context
- Run `air format .` before committing changes to ensure consistent
  formatting

### Documentation

- Use roxygen2 with Markdown syntax for all function documentation
- Keep each sentence on its own line in roxygen2 comments for better
  readability
- Document internal functions using devtag (work in progress)
- Link to C documentation using `@cdocs` tag:
  `#' @cdocs igraph_function_name`
- Always run
  [`devtools::document()`](https://devtools.r-lib.org/reference/document.html)
  after updating documentation

### Naming Conventions

- Use `max` for maximal (graph theory term: a vertex is maximal if no
  other vertex dominates it) and `largest` for maximum (the biggest
  value in a set)

## File Structure and Organization

### Test Files

- Test files should align with source files
- `R/name.R` → `tests/testthat/test-name.R`

### Generated Files

**Do not modify these files directly:**

- `src/rinterface.c` (generated by Stimulus)
- `R/aaa-auto.R` (generated by Stimulus)

Update them using:
`make -f Makefile-cigraph src/rinterface.c R/aaa-auto.R`

See `tools/README.md` for guidelines on code generation using the
Stimulus framework.

## Testing

- Add test cases for all new functionality
- For newly created autogenerated functions, always add a test to
  `test-aaa-auto.R`
- Test file naming should mirror source file naming
- Run tests frequently during development and at the end:
  `testthat::test_local(reporter = "check")`
